<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ordinal-Sequencer</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <header>
      <h1>Ordinal-Sequencer</h1>
    </header>
    <main id="app">
      <section id="transport-controls"></section>
      <section id="sequencer-grid"></section>
    </main>
    <footer>
      <p>Built with ToneJS on Bitcoin via Ordinals.</p>
    </footer>

    <script type="module">
      const TONE_ORDINALS_URL = 'https://ordinals.com/content/04813d7748d918bd8a3069cb1823ebc9586f0ce16cd6a97a784581ec38d13062i0';

      import(TONE_ORDINALS_URL)
        .then(module => {
          window.Tone = module.default;
          console.log('[Ordinal-Sequencer] Tone.js loaded:', window.Tone?.version ?? 'Unknown');
          boot();
        })
        .catch(err => {
          console.error('[Ordinal-Sequencer] Critical Tone.js load error:', err);
          document.body.innerHTML = `
            <div style="text-align: center; padding: 2rem; font-family: sans-serif;">
              <h2>Failed to Load Audio Engine</h2>
              <p>Tone.js could not be loaded from the Bitcoin blockchain.</p>
              <p>Please check your internet connection and try again.</p>
            </div>
          `;
        });

      function boot() {
        // Import all modules after Tone.js is loaded
        import('./stateManager.js');
        import('./eventBus.js');
        import('./audioEngine.js');
        import('./playbackScheduler.js');
        import('./sequencerGrid.js');
        import('./transportController.js');
        import('./midiInput.js');
        import('./blockchainPersistence.js');
        import('./presetManager.js');
        import('./appBootstrap.js').then(({ bootstrap }) => {
          window.addEventListener('DOMContentLoaded', () => {
            bootstrap();
          });
        });
      }
    </script>

    <noscript>
      <p style="text-align: center; padding: 2rem; font-family: sans-serif;">
        This application requires JavaScript to run. Please enable it in your browser.
      </p>
    </noscript>
  </body>
</html>