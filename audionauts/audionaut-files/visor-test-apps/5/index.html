<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>B.A.M. HUD Scene Programmer v2.1</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter&family=VT323&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Helmet & HUD Display -->
  <div class="helmet-section">
    <div class="helmet-container">
      <img src="helmet.png" class="helmet-img" alt="Helmet">
      <div class="visor-hud" id="visorHud">
        <!-- HUD layers are rendered here by hud.js -->
      </div>
    </div>
  </div>

  <!-- Main Control Panel -->
  <div class="control-panel" id="controlPanel">
    <h2>HUD PROGRAMMER v2.1</h2>
    
    <!-- Global Controls -->
    <fieldset>
      <legend>Global Controls</legend>
      <div class="control-grid" style="grid-template-columns: 1fr 1fr;">
        <div class="control-group">
          <label for="hudMode">HUD View:</label>
          <select id="hudMode" data-key="viewMode">
            <option value="normal" selected>Normal (Inside)</option>
            <option value="mirrored">Mirrored (Outside)</option>
          </select>
        </div>
        <div class="control-group">
            <label>Playback Mode:</label>
            <div class="toggle-buttons">
                <button data-action="toggle-loop" id="loopBtn">Loop</button>
                <button data-action="toggle-shuffle" id="shuffleBtn">Shuffle</button>
            </div>
        </div>
      </div>
      
      <!-- START: NEW HUD Opacity Controls -->
      <div class="control-group" style="margin-top: 20px;">
        <label for="globalOpacitySlider" id="globalOpacityLabel">
          Global HUD Opacity: <span>100%</span>
        </label>
        <input type="range" id="globalOpacitySlider" min="0" max="1" step="0.01" value="1">
      </div>
      <button data-action="toggle-hud-visibility" id="toggleHudBtn" class="danger-btn">
        Toggle HUD Visibility
      </button>
      <!-- END: NEW HUD Opacity Controls -->
      
      <div class="playlist-controls">
        <button data-action="play" id="playBtn">Play</button>
        <button data-action="stop" id="stopBtn">Stop</button>
        <button data-action="prev" title="Previous Scene (Left Arrow)">Prev</button>
        <button data-action="next" title="Next Scene (Right Arrow)">Next</button>
      </div>
    </fieldset>

    <!-- Playlist Management -->
    <fieldset>
      <legend>Playlist & Presets</legend>
      <div id="playlist-container" class="playlist-display">
        <!-- Playlist rendered by JS -->
      </div>
      <div class="button-row">
        <button data-action="add-scene">Add New Scene</button>
        <button data-action="clear-playlist" id="clearBtn">Clear Playlist</button>
      </div>
      <div class="button-row">
        <button data-action="save-playlist">Save Preset</button>
        <button onclick="document.getElementById('load-playlist-input').click();">Load Preset</button>
        <input type="file" id="load-playlist-input" style="display:none;" accept=".json">
      </div>
       <button data-action="load-demo" class="demo-btn">Load Simple Demo</button>
        <div class="button-row">
            <button data-action="generate-long-playlist">Generate Asset Showcase</button>
            <button data-action="generate-themed-playlist">Generate Themed (PUNX)</button>
        </div>
    </fieldset>

    <!-- Scene & Layer Editors -->
    <div id="editor-section">
      <!-- Populated when a scene is selected -->
    </div>
  </div>

  <script type="module" src="hud.js"></script>
</body>
</html>