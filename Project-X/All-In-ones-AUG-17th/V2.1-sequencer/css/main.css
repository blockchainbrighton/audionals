:root{
  --bg-main:#1a1c20;--bg-surface:#25282e;--bg-inset:#111214;
  --fg-main:#e1e3e8;--fg-muted:#8c919c;--border-color:#363a42;
  --primary:#5d87ff;--primary-light:#83a3ff;--primary-dark:#4d75e6;
  --cell-on:#5d87ff;--cell-note:#2ecf94;--playhead:#ffab40;
  --danger:#ff5d5d;--danger-dark:#e64d4d;
  --font:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  --shadow-sm:0 2px 4px rgba(0,0,0,.1)
}

*,*::before,*::after{box-sizing:border-box}
html,body{margin:0;background:var(--bg-main);color:var(--fg-main);font:14px/1.4 var(--font);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}

.container{max-width:1300px;margin:0 auto;padding:1.5rem;display:flex;flex-direction:column;gap:1.5rem}
header{display:flex;flex-wrap:wrap;gap:1rem;align-items:center;justify-content:space-between;padding-bottom:1.25rem;border-bottom:1px solid var(--border-color)}
.title{margin:0;font-size:1.25rem;font-weight:600}

.panel{background:var(--bg-surface);border-radius:12px;border:1px solid var(--border-color);padding:1rem;box-shadow:var(--shadow-sm)}
.panel-title{font-weight:600;margin:0 0 .75rem;border-bottom:1px solid var(--border-color);padding-bottom:.6rem;font-size:1rem}

.row{display:flex;gap:1rem;align-items:center;padding:.4rem 0}
.label{font-weight:500;color:var(--fg-muted);text-align:right;width:90px;flex-shrink:0}
.controls{display:flex;flex-wrap:wrap;gap:.75rem;align-items:center;width:100%}
.controls.pad-b{padding-bottom:.5rem}

button, label.button{
  padding:8px 14px;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-surface);
  color:var(--fg-main);font-weight:500;cursor:pointer;transition:background-color .2s,border-color .2s,transform .1s;
  box-shadow:0 1px 2px rgba(0,0,0,.1);display:inline-flex;align-items:center;gap:.4rem
}
button:hover, label.button:hover{background:#31343a;border-color:#4a4e57}
button:active, label.button:active{transform:translateY(1px)}
.btn-primary{background:var(--primary);border-color:var(--primary-dark);color:#fff}
.btn-primary:hover{background:var(--primary-light);border-color:var(--primary)}
.btn-muted{background:#363a42;border-color:#4a4e57}
.btn-muted:hover{background:#4a4e57}
.btn-danger{background:var(--danger);border-color:var(--danger-dark);color:#fff}
.btn-danger:hover{background:#ff7a7a}
.active{background:var(--primary-light)!important;border-color:var(--primary-dark)!important;color:#fff!important;box-shadow:inset 0 1px 3px rgba(0,0,0,.2)}

input[type="number"],input[type="text"],select{
  padding:8px 12px;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-inset);color:var(--fg-main);font-family:var(--font);min-width:0
}
input[type="number"]:focus,input[type="text"]:focus,select:focus{outline:2px solid var(--primary);outline-offset:2px;border-color:var(--primary)}
input[type="file"]{display:none}

.pill-group{display:flex;align-items:center;gap:.5rem}
.pill{display:inline-flex;gap:.5rem;align-items:center;padding:8px 12px;border:1px solid var(--border-color);border-radius:999px;background:var(--bg-surface);font-size:13px}
.pill input[type="checkbox"]{accent-color:var(--primary)}

.grid-container{display:flex;flex-direction:column;gap:1rem;padding:0 .5rem}
.grid{display:grid;grid-template-columns:repeat(64,1fr);gap:3px}
.cell{aspect-ratio:1.5/1;border:1px solid var(--border-color);background:var(--bg-surface);border-radius:3px;cursor:pointer;position:relative;transition:background-color .1s,border-color .1s, opacity .15s}
.cell:hover{background:#31343a}
.cell.on{background:var(--cell-on);border-color:var(--primary-light)}
.cell.note{background:var(--cell-note);border-color:#57d9a9}
.cell.playhead::after{content:"";position:absolute;inset:-3px;border:2px solid var(--playhead);border-radius:5px;pointer-events:none;animation:pulse 1s infinite alternate}
@keyframes pulse{from{opacity:.7}to{opacity:1}}

.barMarks{display:grid;grid-template-columns:120px repeat(16,1fr);margin-bottom:.5rem;padding:0 .5rem}
.barMarks div{text-align:left;font-size:11px;color:var(--fg-muted);border-left:1px solid var(--border-color)}
.barMarks div:first-child{border-left:none}

.channel-strip{display:flex;gap:1rem;align-items:flex-start;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid var(--border-color)}
.channel-strip:last-child{border-bottom:none;margin-bottom:0}
.channel-info{display:flex;flex-direction:column;gap:.5rem;width:105px;flex-shrink:0}
.channel-grid-wrapper{flex-grow:1}

#keyboard{--white-count:14;--white-w:calc(100%/var(--white-count));display:flex;width:100%;padding:1rem;background:var(--bg-inset);border-radius:8px;box-shadow:inset 0 2px 8px rgba(0,0,0,.3);margin-top:1rem;position:relative;overflow:hidden}
.key{position:relative;border:1px solid #222;border-radius:5px;cursor:pointer;display:flex;align-items:flex-end;justify-content:center;padding-bottom:8px;font-size:11px;color:#333;user-select:none;box-shadow:inset 0 0 5px rgba(255,255,255,.1),0 2px 3px rgba(0,0,0,.4);transition:background-color .08s}
.key.white{height:120px;width:var(--white-w);background:linear-gradient(to bottom,#f9f9f9,#d1d1d1);z-index:1}
.key.black{height:75px;width:calc(var(--white-w)*.6);background:linear-gradient(to bottom,#444,#111);color:#eee;z-index:2;margin:0 calc(var(--white-w)*-.3);box-shadow:inset 0 -2px 5px rgba(255,255,255,.2),0 3px 5px rgba(0,0,0,.6)}
.key.active{background:var(--primary-light)!important;border-color:var(--primary-dark);transform:scale(.985)}

#status{padding:8px 12px;color:var(--fg-muted);font-size:13px;min-height:2em}
.hint{font-size:12px;color:var(--fg-muted);opacity:.9}
.hint-left{ text-align:left;margin:-.5rem 0 1rem }

.dropzone{border:1px dashed var(--border-color);border-radius:10px;padding:.75rem;opacity:.85}
.dropzone.drag{background:rgba(131,163,255,.08);border-color:var(--primary)}

.synth-head{ margin-bottom:.5rem; border:1px solid var(--border-color); border-radius:10px; background:var(--bg-inset); }
.synth-head>summary{ list-style:none; cursor:pointer; padding:.6rem .8rem; font-weight:600; display:flex; align-items:center; gap:.5rem; }
.synth-head>summary::before{ content:"â–¸"; transition:transform .15s ease; opacity:.8; }
.synth-head[open]>summary::before{ transform:rotate(90deg); }
.synth-head .body{ padding:.6rem .8rem .8rem; display:grid; grid-template-columns:120px 1fr; gap:.4rem .8rem; }
.synth-head label{ color:var(--fg-muted); align-self:center; }
.synth-head input[type="range"]{ width:100%; }
.synth-head .inline{ display:flex; gap:.5rem; align-items:center; }
.synth-head select,.synth-head input[type="range"],.synth-head input[type="number"]{
  background:var(--bg-surface); border:1px solid var(--border-color); border-radius:8px; color:var(--fg-main); padding:.35rem .5rem;
}

.rec-arm-btn {
  background-color: #4a4e57;
  border-color: #363a42;
  color: #fff;
  width: 36px;
}
.rec-arm-btn:hover {
  background-color: #5f636e;
}
.rec-arm-btn.active {
  background-color: var(--danger) !important;
  border-color: var(--danger-dark) !important;
  box-shadow: inset 0 1px 3px rgba(0,0,0,.3) !important;
}

.w-64{ width:64px }

