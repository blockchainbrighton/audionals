<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Title Journey — Clear, Streamlined, Full Effects</title>

<!--
  Module goals (clarity-first):
  • One simple lifecycle: ENTER → HOLD → EXIT
  • Three timing controls only: enterMs, holdMs, exitMs
  • Enter effects & Exit effects are fully mix-and-match
  • Per-letter motion (rotation/position/scale) + whole-title style overlays
  • Global classic styles included: Rainbow (global) & Hologram (global)
  • If Exit not provided, graceful fade-out fallback
  • Small, readable effect DSL (tweenChars/outChars)
-->

<style>
  :root{
    --bg:#0d1021; --ink:#fff; --accent:#ff2b85;
    --glass:#ffffff18; --glass2:#ffffff2a;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    min-height:100vh;display:grid;place-items:center;background:
      radial-gradient(60% 80% at 70% 20%, #1c1f3c 0%, transparent 60%),
      radial-gradient(80% 60% at 20% 80%, #182447 0%, transparent 60%), var(--bg);
    color:var(--ink);font:600 15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial;padding:20px
  }
  .wrap{max-width:1100px;width:100%;text-align:center}
  h1{font-size:clamp(20px,3vw,28px);opacity:.85;letter-spacing:.12em;text-transform:uppercase;margin-bottom:14px}

  /* Stage & Title */
  .stage{height:clamp(140px,32vw,260px);display:grid;place-items:center;perspective:1000px;margin:18px 0}
  .title{font-weight:900;letter-spacing:.14em;text-transform:uppercase;
         font-size:clamp(32px,9vw,92px);color:var(--accent);text-shadow:0 0 12px #ff2b85aa;white-space:nowrap}
  .char{display:inline-block;transform-origin:center;will-change:transform,opacity,filter}

  .meta{opacity:.8;margin-top:6px;font-size:13px}
  .bar{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin:14px 0}
  input,select,button{
    background:var(--glass);border:1px solid var(--glass2);color:var(--ink);
    border-radius:10px;padding:10px 12px;font-weight:600;backdrop-filter:blur(6px)
  }
  input[type="number"]{width:110px}
  input[type="text"]{width:min(520px,92vw)}
  button{cursor:pointer}
  button:hover{background:#ffffff29}
  .tiny{font-size:12px;opacity:.7;margin-top:8px}

  /* ───────────────── Hold-phase overlays (apply to .title as a whole) ───────────────── */
  /* Subtle neon pulse (works with any color swatch) */
  @keyframes neonPulse{0%,100%{text-shadow:0 0 4px #fff,0 0 12px #ff2b85,0 0 28px #ff2b85}50%{text-shadow:0 0 2px #fff,0 0 6px #ff7ab3,0 0 18px #ff7ab3}}
  .style-neon{animation:neonPulse 2.2s ease-in-out infinite}

  /* Hue rotation rainbow (continuous gradient shift) */
  @keyframes hueShift{to{filter:hue-rotate(360deg)}}
  .style-rainbow{animation:hueShift 6s linear infinite}

  /* Hologram cycling (title-wide color glow loop) */
  @keyframes hologramKF{0%,100%{text-shadow:0 0 10px #0ff;color:#0ff}25%{text-shadow:0 0 10px #f0f;color:#f0f}50%{text-shadow:0 0 10px #ff0;color:#ff0}75%{text-shadow:0 0 10px #0f0;color:#0f0}}
  .style-hologram{animation:hologramKF 4.2s linear infinite}

  /* Matrix/Fire stylings (title-wide) */
  @keyframes matrixGlow{0%,100%{text-shadow:0 0 10px #0f0;color:#0f0}50%{text-shadow:0 0 4px #0a0;color:#0a0}}
  .style-matrix{animation:matrixGlow 1.6s ease-in-out infinite}
  @keyframes fireGlow{0%,100%{text-shadow:0 0 6px #f40,0 0 14px #fa0;color:#ffa552}50%{text-shadow:0 0 8px #f70,0 0 18px #ff0;color:#ffd36b}}
  .style-fire{animation:fireGlow 1.8s ease-in-out infinite}

  /* CLASSIC global rainbow (hard color stops) */
  @keyframes classicRainbow { 0%{color:#f00} 16%{color:#ff7f00} 33%{color:#ff0} 50%{color:#0f0} 66%{color:#0af} 83%{color:#80f} 100%{color:#f00} }
  .style-rainbow-global{animation:classicRainbow 3.6s linear infinite;text-shadow:0 0 10px currentColor,0 0 24px currentColor}

  /* CLASSIC global hologram (shared with hologramKF for unity) */
  .style-hologram-global{animation:hologramKF 4.2s linear infinite;text-shadow:0 0 10px currentColor,0 0 26px currentColor}

  /* Quick accent swatches */
  .swatch-pink{color:#ff2b85}
  .swatch-cyan{color:#00ffff}
  .swatch-yellow{color:#ffff5a}
  .swatch-green{color:#00ff95}
  .swatch-blue{color:#4db3ff}
  .swatch-orange{color:#ff8a3d}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Title Journey — Arrive • Hold • Leave</h1>

    <!-- Stage displays the animated title -->
    <div class="stage"><div id="title" class="title swatch-pink">Audio GNARLS</div></div>
    <div id="meta" class="meta" aria-live="polite">—</div>

    <!-- Controls: text, effect choices, styles, colors -->
    <div class="bar" aria-label="Effect selectors">
      <input id="text" type="text" value="Audio GNARLS" aria-label="Title text"/>
      <select id="inSel" aria-label="Enter effect"></select>
      <select id="outSel" aria-label="Exit effect"></select>
      <select id="styleSel" aria-label="Hold style">
        <option value="style-none">Style • None</option>
        <option value="style-neon">Style • Neon</option>
        <option value="style-rainbow">Style • Rainbow (Hue Rotate)</option>
        <option value="style-rainbow-global">Style • Rainbow (Global)</option>
        <option value="style-hologram">Style • Hologram (Per-Frame)</option>
        <option value="style-hologram-global">Style • Hologram (Global)</option>
        <option value="style-matrix">Style • Matrix</option>
        <option value="style-fire">Style • Fire</option>
      </select>
      <select id="swatchSel" aria-label="Color swatch">
        <option value="swatch-pink">Color • Pink</option>
        <option value="swatch-cyan">Color • Cyan</option>
        <option value="swatch-yellow">Color • Yellow</option>
        <option value="swatch-green">Color • Green</option>
        <option value="swatch-blue">Color • Blue</option>
        <option value="swatch-orange">Color • Orange</option>
      </select>
    </div>

    <!-- Timing & transport -->
    <div class="bar" aria-label="Timing and transport">
      <label>Enter (ms) <input id="tIn"  type="number" min="0" step="50" value="1000"></label>
      <label>Hold (ms)  <input id="tHold"type="number" min="0" step="50" value="1000"></label>
      <label>Exit (ms)  <input id="tOut" type="number" min="0" step="50" value="1000"></label>
      <button id="play">Play</button>
      <button id="prev">Prev</button>
      <button id="next">Next</button>
      <button id="random">Random</button>
    </div>

    <div class="tiny">Any Enter × any Exit. If Exit is “Auto/Paired” and the Enter has a pair, it’s used; otherwise we fade-out over Exit time.</div>
  </div>

<script>
(()=>{
  // Shorthand DOM helpers
  const $ = (id)=>document.getElementById(id);
  const titleEl = $('title');
  const metaEl  = $('meta');
  const textIn = $('text');
  const inSel = $('inSel');
  const outSel = $('outSel');
  const styleSel = $('styleSel');
  const swatchSel = $('swatchSel');
  const tIn = $('tIn');
  // Randomization: toggle per-letter coloring
  let perLetterColor = false;
  const tHold = $('tHold');
  const tOut = $('tOut');
  const playBtn = $('play');
  const prevBtn = $('prev');
  const nextBtn = $('next');
  const rndBtn  = $('random');

  /* ─────────────────────────── Animation micro-DSL ─────────────────────────── */
  const sleep = (ms)=> new Promise(r=> setTimeout(r, ms));

  // Render the title into span.char nodes (per-letter control)
  function setTitle(txt){
    titleEl.innerHTML = [...(txt||'')]
      .map(ch => ch===' ' ? '<span class="char">&nbsp;</span>' : `<span class="char">${ch}</span>`)
      .join('');
    return titleEl.querySelectorAll('.char');
  }

  // Apply hold-phase style & color swatch to the whole title
  function applyStyle(){
    // If per-letter coloring is on, omit the swatch class (colors will be set inline per char)
    titleEl.className = `title ${styleSel.value} ${perLetterColor ? '' : swatchSel.value}`.trim();
  }

  // Generic per-character tween for ENTER
  function tweenChars(chars, {from,to='none',ms=700,delay=0.05,ease='cubic-bezier(.2,.8,.2,1)',extra}={}){
    chars.forEach((ch,i)=>{
      const st = ch.style;
      st.opacity = 0;
      st.transform = (typeof from==='function' ? from(i) : from) || 'none';
      st.filter = 'blur(2px)';
      st.transition = `transform ${ms}ms ${ease}, opacity ${ms}ms ${ease}, filter ${ms}ms ${ease}`;
      st.transitionDelay = (i*delay)+'s';
      if (extra) extra(ch,i);
      requestAnimationFrame(()=>{ st.opacity = 1; st.transform = to; st.filter='none'; });
    });
  }

  // Generic per-character tween for EXIT
  function outChars(chars, {to,ms=600,delay=0.05,ease='ease',extra}={}){
    chars.forEach((ch,i)=>{
      const st = ch.style;
      st.transition = `transform ${ms}ms ${ease}, opacity ${ms}ms ${ease}, filter ${ms}ms ${ease}`;
      st.transitionDelay = (i*delay)+'s';
      if (extra) extra(ch,i);
      requestAnimationFrame(()=>{ st.opacity = 0; st.transform = (typeof to==='function' ? to(i) : to) || 'none'; st.filter='blur(1px)'; });
    });
  }

  // Random helpers for organic motion
  const R = (a,b)=> a + Math.random()*(b-a);
  // Swatch palettes for per-letter coloring
  const palettes = {
    'swatch-pink':   ['#ff2b85','#ff5aa1','#ff7ab3','#ffa3ca'],
    'swatch-cyan':   ['#00ffff','#66ffff','#99ffff','#ccffff'],
    'swatch-yellow': ['#ffff5a','#fff27a','#ffe58a','#fff7a6'],
    'swatch-green':  ['#00ff95','#4dffb7','#80ffd0','#b3ffe5'],
    'swatch-blue':   ['#4db3ff','#7cc8ff','#a3d8ff','#cfeaff'],
    'swatch-orange': ['#ff8a3d','#ffa35f','#ffb47a','#ffd1ad']
  };
  function colorizeChars(chars){
    const pal = palettes[swatchSel.value] || ['#ffffff'];
    chars.forEach((ch,i)=>{ ch.style.color = pal[i % pal.length]; });
  }
  function clearCharColors(chars){ chars.forEach(ch=>{ ch.style.color = ''; }); }

  /* ─────────────────────── Effect library (concise & broad) ─────────────────────── */
  // Entrances (functions call tweenChars)
  const entrances = {
    fade      : (c,ms)=> tweenChars(c,{from:'none',ms,ease:'ease',delay:.02,extra:(ch)=>{ch.style.opacity=0}}),
    zoom      : (c,ms)=> tweenChars(c,{from:'scale(.6)',ms}),
    slideL    : (c,ms)=> tweenChars(c,{from:'translateX(-120%) rotate(-8deg)',ms}),
    slideR    : (c,ms)=> tweenChars(c,{from:'translateX(120%) rotate(8deg)',ms}),
    slideU    : (c,ms)=> tweenChars(c,{from:'translateY(120%)',ms}),
    flipY     : (c,ms)=> tweenChars(c,{from:'rotateY(-90deg) scale(.8)',ms,ease:'cubic-bezier(.175,.885,.32,1.275)'}),
    rotateZ   : (c,ms)=> tweenChars(c,{from:()=>`rotate(${R(-240,240)}deg) scale(.2)`,ms}),
    lightIn   : (c,ms)=> tweenChars(c,{from:'translateX(110%) skewX(-30deg)',ms,ease:'cubic-bezier(.25,.46,.45,.94)'}),
    bounceIn  : (c,ms)=> tweenChars(c,{from:'translateY(-120%) scale(.7)',ms,ease:'cubic-bezier(.34,1.56,.64,1)',delay:.04}),
    pop       : (c,ms)=> tweenChars(c,{from:'scale(.2) translateY(12px)',ms:ms*0.9,delay:.06,ease:'cubic-bezier(.2,1,.2,1)'}),
    wave      : (c,ms)=> tweenChars(c,{from:'translateY(40px) rotate(-5deg)',ms,ease:'ease-in-out',delay:.05,extra:(ch,i)=>{ch.style.transitionDelay=(i*.05+ .08*Math.sin(i*.6))+'s'}}),
    scatter   : (c,ms)=> tweenChars(c,{from:()=>`translate(${R(-220,220)}px,${R(-140,140)}px) rotate(${R(-180,180)}deg) scale(${R(.2,.8)})`,ms:ms*1.1,delay:.04}),
    spinIn    : (c,ms)=> tweenChars(c,{from:()=>`rotate(${R(-360,360)}deg) scale(.2)`,ms,ease:'ease-out'}),
    lightDrop : (c,ms)=> tweenChars(c,{from:'translateY(-120%) skewY(-8deg) scale(.9)',ms})
  };

  // Exits (mirror with outChars). If a preset lacks an explicit exit, we use fade.
  const exits = {
    fade      : (c,ms)=> outChars(c,{to:'none',ms,ease:'ease',delay:.02}),
    zoom      : (c,ms)=> outChars(c,{to:'scale(.6)',ms}),
    slideR    : (c,ms)=> outChars(c,{to:'translateX(120%) rotate(8deg)',ms}),
    slideL    : (c,ms)=> outChars(c,{to:'translateX(-120%) rotate(-8deg)',ms}),
    slideD    : (c,ms)=> outChars(c,{to:'translateY(120%)',ms}),
    flipY     : (c,ms)=> outChars(c,{to:'rotateY(90deg) scale(.85)',ms}),
    rotateZ   : (c,ms)=> outChars(c,{to:()=>`rotate(${R(-220,220)}deg) scale(.6) translateY(${R(-40,40)}px)`,ms}),
    lightOut  : (c,ms)=> outChars(c,{to:'translateX(110%) skewX(30deg)',ms}),
    bounceOut : (c,ms)=> outChars(c,{to:'translateY(120%) scale(.9)',ms,ease:'cubic-bezier(.34,1.56,.64,1)',delay:.04}),
    scatter   : (c,ms)=> outChars(c,{to:()=>`translate(${R(-260,260)}px,${R(-180,180)}px) rotate(${R(-260,260)}deg) scale(.1)`,ms:ms*1.05,delay:.035}),
    spinOut   : (c,ms)=> outChars(c,{to:()=>`rotate(${R(240,480)}deg) scale(.1)`,ms})
  };

  // Preset catalog: pairs common in/out combos but still mixable via UI
  const presets = [
    {name:'Fade',          in:'fade',     out:'fade'},
    {name:'Zoom',          in:'zoom',     out:'zoom'},
    {name:'Slide Left',    in:'slideL',   out:'slideR'},
    {name:'Slide Right',   in:'slideR',   out:'slideL'},
    {name:'Slide Up',      in:'slideU',   out:'slideD'},
    {name:'Flip Y',        in:'flipY',    out:'flipY'},
    {name:'Rotate Z',      in:'rotateZ',  out:'rotateZ'},
    {name:'Light Speed',   in:'lightIn',  out:'lightOut'},
    {name:'Bounce In',     in:'bounceIn', out:'bounceOut'},
    {name:'Pop Stagger',   in:'pop',      out:'fade'},
    {name:'Wave',          in:'wave',     out:'fade'},
    {name:'Scatter In',    in:'scatter',  out:'scatter'},
    {name:'Spin In',       in:'spinIn',   out:'spinOut'},
    {name:'Light Drop',    in:'lightDrop',out:'slideD'}
  ];

  // Populate selects
  const opt = (v,l)=> `<option value="${v}">${l}</option>`;
  inSel.innerHTML  = presets.map((p,i)=>opt(i, `In • ${p.name}`)).join('');
  outSel.innerHTML = opt('auto','Exit • Auto/Paired')
                   + presets.map((p,i)=>opt(i, `Exit • ${p.name}`)).join('')
                   + opt('fade','Exit • Fade');

  let idx = 0; // tracks current ENTER preset index for prev/next/random UX

  function exitLabel(v, inIdx){
    if (v==='auto') return presets[inIdx].out ? `Paired • ${presets[inIdx].name}` : 'Fade';
    if (v==='fade') return 'Fade';
    const p = presets[+v]; return p ? p.name : 'Fade';
  }

  // Core journey runner: ENTER → HOLD → EXIT with graceful fallback
  async function runJourney({text, inIdx, outVal, enterMs, holdMs, exitMs}){
    applyStyle();
    const chars = setTitle(text);

    // Apply per-letter vs whole-title coloring mode
    if (perLetterColor) colorizeChars(chars); else clearCharColors(chars);

    // ENTER
    const inKey = presets[inIdx].in;
    (entrances[inKey] || entrances.fade)(chars, enterMs);
    metaEl.textContent = `${presets[inIdx].name} → hold → ${exitLabel(outVal,inIdx)}`;

    // Allow a little slack for staggered transitions
    await sleep(enterMs + Math.max(0, chars.length*20 - 120));

    // HOLD (overlay styles already applied to .title)
    await sleep(Math.max(0, holdMs));

    // EXIT (auto pair > explicit selection > fade)
    let exitFn = null;
    if (outVal==='auto'){
      const outKey = presets[inIdx].out;
      exitFn = exits[outKey] || exits.fade;
    } else if (outVal==='fade') {
      exitFn = exits.fade;
    } else {
      const p = presets[+outVal];
      exitFn = exits[p?.out] || exits[p?.in] || exits.fade;
    }

    exitFn(chars, exitMs);
    await sleep(exitMs + Math.max(0, chars.length*20 - 120));

    // Cleanup between journeys to avoid leftover DOM state
    titleEl.innerHTML = '';
  }

  // Read UI and run once
  function playFromUI(){
    const text  = textIn.value || 'Audio GNARLS';
    const inIdx = +inSel.value || 0;
    const outVal= outSel.value || 'auto';
    const enterMs = Math.max(0, +tIn.value||0);
    const holdMs  = Math.max(0, +tHold.value||0);
    const exitMs  = Math.max(0, +tOut.value||0);
    idx = inIdx;
    runJourney({text,inIdx,outVal,enterMs,holdMs,exitMs});
  }

  /* ─────────────────────────── Controls wiring ─────────────────────────── */
  playBtn.addEventListener('click', playFromUI);
  prevBtn.addEventListener('click', ()=>{ idx=(idx-1+presets.length)%presets.length; inSel.value=idx; playFromUI(); });
  nextBtn.addEventListener('click', ()=>{ idx=(idx+1)%presets.length; inSel.value=idx; playFromUI(); });
  rndBtn .addEventListener('click', ()=>{
    // Randomize everything EXCEPT text and timings
    // 1) Random enter preset
    let n = (Math.random()*presets.length)|0;
    if (presets.length>1 && n===idx) n=(n+1)%presets.length;
    idx = n; inSel.value = idx;
    // 2) Random exit: auto, fade, or another preset
    const exitModes = ['auto','fade','preset'];
    const mode = exitModes[(Math.random()*exitModes.length)|0];
    if (mode==='preset') {
      outSel.value = (Math.random()*presets.length)|0;
    } else {
      outSel.value = mode;
    }
    // 3) Random style overlay
    const styles = Array.from(styleSel.options).map(o=>o.value);
    styleSel.value = styles[(Math.random()*styles.length)|0];
    // 4) Random swatch color
    const swatches = Array.from(swatchSel.options).map(o=>o.value);
    swatchSel.value = swatches[(Math.random()*swatches.length)|0];
    // 5) Randomize per-letter vs whole-title coloring (50/50)
    perLetterColor = Math.random() < 0.5;
    applyStyle();
    playFromUI();
  });
  styleSel.addEventListener('change', applyStyle);
  swatchSel.addEventListener('change', applyStyle);

  // Initial render
  inSel.value = idx; outSel.value = 'auto'; applyStyle(); playFromUI();
})();
</script>
</body>
</html>
