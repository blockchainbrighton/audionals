<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modular Clickable Image with Sound Controls</title>
    <style>
        /* --- CSS Styling Zone --- */
        html, body {
            height: 100%; margin: 0; padding: 0; overflow: hidden; box-sizing: border-box;
        }
        body {
            display: flex; flex-direction: column;
            justify-content: center; align-items: center; background-color: #f0f0f0;
            font-family: sans-serif;
        }
        #clickableImage {
            height: 65vh; width: 65vh; /* Smaller to fit controls */
            max-height: 500px; /* Max height */
            max-width: 500px; /* Max width */
            object-fit: cover; cursor: pointer;
            border: 2px solid black; box-shadow: 3px 3px 8px rgba(0,0,0,0.3);
            margin-bottom: 15px;
            background-color: #ddd; /* Placeholder background */
        }
        /* HTML Audio Player is no longer used by main logic, but keep for structure */
        #clickSoundPlayer {
            display: none;
        }
        .controls {
            display: flex;
            flex-direction: column; /* Stack control groups */
            gap: 15px;
            align-items: center;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
            min-width: 300px; /* Ensure controls have some width */
            max-width: 90%; /* Prevent excessive width on large screens */
            box-sizing: border-box;
        }
        .control-group {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            gap: 10px;
            align-items: center;
            width: 100%;
            justify-content: space-between; /* Align labels and inputs nicely */
        }
         .control-group label, .control-group button {
            white-space: nowrap; /* Prevent labels/buttons breaking */
         }
        .control-group input[type="range"] {
            flex-grow: 1; /* Allow sliders to take available space */
            min-width: 100px; /* Prevent sliders becoming too small */
            cursor: pointer;
        }
         .control-group input[type="range"]:disabled {
             cursor: not-allowed;
         }
        .control-group span {
            min-width: 60px; /* Give display spans consistent width */
            text-align: right;
            font-weight: bold;
            font-size: 0.9em;
        }
        .error-message {
             color: red;
             padding: 8px;
             margin: 5px 0;
             background-color: #fee;
             border: 1px solid red;
             border-radius: 4px;
             width: 100%;
             box-sizing: border-box;
             text-align: center;
             font-size: 0.9em;
        }

        /* Style buttons when active */
        #loopToggle.active,
        #reverseButton.active { /* <<<<<<<< APPLIES TO BOTH BUTTONS NOW */
            background-color: #a0e0a0; /* Slightly darker green */
            font-weight: bold;
            border-color: #65c365; /* Darker green border for active state */
            box-shadow: inset 1px 1px 3px rgba(0,0,0,0.2); /* Inner shadow */
        }

        /* General button styling */
        button {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #f8f8f8;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            font-size: 0.9em;
        }
        button:hover:not(:disabled) {
            background-color: #e0e0e0;
            border-color: #bbb;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* --- End CSS Styling Zone --- */
    </style>
</head>
<body>

   <!-- HTML Elements -->
   <img id="clickableImage" alt="Clickable Image Area" src=""> <!-- src left empty, will be set by JS -->
   <audio id="clickSoundPlayer" preload="metadata">
       <!-- This element is not directly used for playback anymore -->
       Your browser does not support the audio element.
   </audio>

   <!-- Updated Controls Section -->
   <div class="controls">
        <div class="control-group">
            <button id="playOnceButton">Play Once</button>
            <button id="loopToggle">Play Loop: Off</button>
            <!-- Updated Text and Title for Reverse Button -->
            <button id="reverseButton" title="Toggle Reverse Playback">Reverse: Off</button>
        </div>

        <div class="control-group">
           <label for="tempoSlider">Tempo:</label>
           <input type="range" id="tempoSlider" min="1" max="400" step="1" value="78">
           <span id="bpmValue">78 BPM</span>
       </div>

       <div class="control-group">
           <label for="pitchSlider">Pitch/Speed:</label>
           <input type="range" id="pitchSlider" min="0.01" max="10.0" step="0.01" value="1.0">
           <span id="pitchValue">100%</span>
       </div>

       <div class="control-group">
           <label for="volumeSlider">Volume:</label>
           <input type="range" id="volumeSlider" min="0" max="1.5" step="0.01" value="1.0">
           <span id="volumeValue">100%</span>
       </div>
       <!-- Error messages will be appended here by JS -->
   </div>
   <!-- End HTML Elements -->



    <!-- --- Embedded Base64 Data Zone (as JS global variables) --- -->
    <script>
        // Make sure these are defined *before* main.js runs
        // These variables will exist in the global scope (window)
        const imageBase64 = `/9j...abbreviated for brevity...//Z`; // Injected Image Data
        const audioBase64_Opus = `SUQ...abbreviated for brevity...VVV`; // Injected Audio Data
    </script>
    <!-- --- End Embedded Base64 Data Zone --- -->


  
       <!-- Placeholder for error messages -->
   </div>
   <!-- End HTML Elements -->

   <!-- Load Main JS Module (Keep as is) -->
   <script type="module" src="js/main.js"></script>

</body>
</html>