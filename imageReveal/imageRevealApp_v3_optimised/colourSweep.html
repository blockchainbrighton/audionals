<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Colour Sweep Player</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <style>
    /* --- global stage ---------------------------------------------------- */
    html,
    body {
      margin: 0;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      cursor: pointer;              /* hint that a click starts playback */
    }

    /* --- force‑override default UI injected by imageRevealCore ----------- */
    #imageRevealContainer {
      position: fixed;
      inset: 0;
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      background: #000 !important;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* hide every child except the canvas */
    #imageRevealContainer > *:not(canvas) {
      display: none !important;
    }

    /* centred square canvas (auto‑injected by imageRevealCore) */
    #imageCanvas {
      width: 90vh;
      height: 90vh;
      max-width: 90vw;
      max-height: 90vh;
      display: block;
      background: #000 !important;
      border: none !important;
    }

    /* invisible helper button used by playbackMgmt.js */
    #playBtn {
      display: none;
    }
  </style>
</head>
<body>
  <!-- hidden button consumed by playbackMgmt.js (needed for toggle) -->
  <button id="playBtn">Play Mix</button>

  <!-- audio & image URLs -------------------------------------------------- -->
  <script id="audio-data">
    const audioParts = [
      "https://ordinals.com/content/055e30b37a547674bd750cd963b9c3e2dfaecfe60833cbb9a377e12b2eea05a6i0",
      "https://ordinals.com/content/a475da90928ae5dba210a6a2708a20278367d46f898acdebe9707c0e43b994cei0",
      "https://ordinals.com/content/797a56f20af6f7016853f817a7041847e82dedd2d2b9246515646e741a3e53b2i0"
    ];
  </script>

  <script id="image-data">
    window.images = [
      "https://ordinals.com/content/01c48d3cceb02215bc3d44f9a2dc7fba63ea63719a2ef1c35d3f0c4db93ab8d5i0"
    ];
  </script>

  <!-- core libraries ------------------------------------------------------ -->
  <script src="playbackMgmt.js"></script>
  <script src="imageLoadMgmt.js"></script>
  <script type="module" src="imageRevealCore.js"></script>
  <script type="module" src="imageRevealPublicApi.js"></script>

  <!-- bootstrapping: pre‑configure 30 s colour‑sweep, run on canvas click -->
  <script type="module">
    import { setupEffect } from './imageRevealPublicApi.js';

    const imgUrl = window.images?.[0] || null;

    /* delay until window "load" so the core has built its UI */
    window.addEventListener('load', async () => {
      if (!imgUrl) {
        console.error('Colour Sweep Player: no image URL provided.');
        return;
      }
      try {
        // prepare the forward brightness‑sweep for 30 seconds
        await setupEffect(imgUrl, 'sweepBrightFwd', 30);
        console.log('Colour sweep ready – click the canvas to start.');
      } catch (err) {
        console.error('Failed to prepare colour sweep:', err);
      }
    });
  </script>
</body>
</html>