const fadeDuration=.01;function notifyVisualizer(e,n){AudionalPlayerMessages.postMessage({action:"activeStep",channelIndex:e,step:n}),document.dispatchEvent(new CustomEvent("internalAudioPlayback",{detail:{action:"activeStep",channelIndex:e,step:n}}))}document.addEventListener("click",(async()=>{"function"==typeof window.ensureAudioContextState?(await window.ensureAudioContextState(),await togglePlayback(),document.dispatchEvent(new CustomEvent("playbackStarted"))):console.error("[fileAndAudioHandling.js] ensureAudioContextState is not defined or not a function")}));const defaultVolume=1;async function togglePlayback(){isToggleInProgress,isToggleInProgress=!0;try{isPlaying?(await stopPlayback(),isPlaying=!1):(await initializePlayback(),isPlaying=!0)}catch(e){console.error("Error during playback toggle:",e)}finally{isToggleInProgress=!1}}function cleanUpWorker(){clearInterval(intervalID),audioWorker?.terminate(),audioCtx.suspend().then((()=>console.log("AudioContext suspended successfully.")))}window.addEventListener("beforeunload",cleanUpWorker);