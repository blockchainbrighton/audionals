// loader_NoBlobs.js
const canvas=document.createElement("canvas");canvas.id="cv",document.body.appendChild(canvas),document.body.style.cssText="\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 100vh;\n    margin: 0;\n";const loadScriptsSequentially=(e,t=0,n)=>{if(t<e.length){const o=document.createElement("script");o.src=e[t],o.onload=()=>loadScriptsSequentially(e,t+1,n),document.head.appendChild(o)}else"function"==typeof n&&n()},initializeApp=()=>{window.cci2=0,window.initialCCI2=0,resetAllStates(),loadJsonFromLocalStorage(window.jsonDataUrl);const e=JSON.parse(localStorage.getItem("jsonData"));if(e){window.settings=e;const t=e.projectSequences;t&&Object.keys(t).length>0?(console.log("[debug] Sequence data is ready:",t),initializeWorker()):console.error("[debug] Sequence data is not ready or empty. Data found:",t)}else console.error("[debug] Error: JSON data not found in localStorage.")},handleSettingsAndScripts=async()=>{await ensureAudioContextState(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeApp):initializeApp()},jsonData=localStorage.getItem("jsonData");jsonData?(console.log("[debug] JSON data found in localStorage:",JSON.parse(jsonData)),loadScriptsSequentially(window.scriptsToLoad,0,handleSettingsAndScripts)):fetch(window.jsonDataUrl).then((e=>e.json())).then((e=>{window.settings=e,localStorage.setItem("jsonData",JSON.stringify(e)),console.log("[debug] Data stored in localStorage:",JSON.stringify(e)),loadScriptsSequentially(window.scriptsToLoad,0,handleSettingsAndScripts)})).catch((e=>console.error("[debug] Error loading settings from URL:",e)));